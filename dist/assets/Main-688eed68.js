import{v as Ee,w as Ae,d as fe,r as _,x as Ie,o as _e,f as W,g as T,h as l,y as Y,z as J,A as Ve,C as Te,j as B,D as ce,T as ge,k as H,q as te,m as S,E as de,_ as ve,i as le,F as Oe,G as ne,H as re,I as se,p as he,l as be,c as Be,J as Le,K as Pe,L as Me}from"./index-19e67411.js";import{P as xe,e as Re}from"./eventsource-17e19c26.js";import{s as Q}from"./services-73bde18f.js";var we={exports:{}};/*!
 * clipboard.js v2.0.11
 * https://clipboardjs.com/
 *
 * Licensed MIT © Zeno Rocha
 */(function(L,C){(function(P,I){L.exports=I()})(Ae,function(){return function(){var U={686:function(r,s,e){e.d(s,{default:function(){return ue}});var u=e(279),i=e.n(u),v=e(370),b=e.n(v),x=e(817),y=e.n(x);function g(f){try{return document.execCommand(f)}catch{return!1}}var w=function(a){var o=y()(a);return g("cut"),o},p=w;function O(f){var a=document.documentElement.getAttribute("dir")==="rtl",o=document.createElement("textarea");o.style.fontSize="12pt",o.style.border="0",o.style.padding="0",o.style.margin="0",o.style.position="absolute",o.style[a?"right":"left"]="-9999px";var t=window.pageYOffset||document.documentElement.scrollTop;return o.style.top="".concat(t,"px"),o.setAttribute("readonly",""),o.value=f,o}var F=function(a,o){var t=O(a);o.container.appendChild(t);var n=y()(t);return g("copy"),t.remove(),n},z=function(a){var o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{container:document.body},t="";return typeof a=="string"?t=F(a,o):a instanceof HTMLInputElement&&!["text","search","url","tel","password"].includes(a==null?void 0:a.type)?t=F(a.value,o):(t=y()(a),g("copy")),t},M=z;function R(f){"@babel/helpers - typeof";return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?R=function(o){return typeof o}:R=function(o){return o&&typeof Symbol=="function"&&o.constructor===Symbol&&o!==Symbol.prototype?"symbol":typeof o},R(f)}var $=function(){var a=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},o=a.action,t=o===void 0?"copy":o,n=a.container,d=a.target,D=a.text;if(t!=="copy"&&t!=="cut")throw new Error('Invalid "action" value, use either "copy" or "cut"');if(d!==void 0)if(d&&R(d)==="object"&&d.nodeType===1){if(t==="copy"&&d.hasAttribute("disabled"))throw new Error('Invalid "target" attribute. Please use "readonly" instead of "disabled" attribute');if(t==="cut"&&(d.hasAttribute("readonly")||d.hasAttribute("disabled")))throw new Error(`Invalid "target" attribute. You can't cut text from elements with "readonly" or "disabled" attributes`)}else throw new Error('Invalid "target" value, use a valid Element');if(D)return M(D,{container:n});if(d)return t==="cut"?p(d):M(d,{container:n})},K=$;function h(f){"@babel/helpers - typeof";return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?h=function(o){return typeof o}:h=function(o){return o&&typeof Symbol=="function"&&o.constructor===Symbol&&o!==Symbol.prototype?"symbol":typeof o},h(f)}function V(f,a){if(!(f instanceof a))throw new TypeError("Cannot call a class as a function")}function c(f,a){for(var o=0;o<a.length;o++){var t=a[o];t.enumerable=t.enumerable||!1,t.configurable=!0,"value"in t&&(t.writable=!0),Object.defineProperty(f,t.key,t)}}function m(f,a,o){return a&&c(f.prototype,a),o&&c(f,o),f}function E(f,a){if(typeof a!="function"&&a!==null)throw new TypeError("Super expression must either be null or a function");f.prototype=Object.create(a&&a.prototype,{constructor:{value:f,writable:!0,configurable:!0}}),a&&k(f,a)}function k(f,a){return k=Object.setPrototypeOf||function(t,n){return t.__proto__=n,t},k(f,a)}function q(f){var a=X();return function(){var t=j(f),n;if(a){var d=j(this).constructor;n=Reflect.construct(t,arguments,d)}else n=t.apply(this,arguments);return N(this,n)}}function N(f,a){return a&&(h(a)==="object"||typeof a=="function")?a:ee(f)}function ee(f){if(f===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return f}function X(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch{return!1}}function j(f){return j=Object.setPrototypeOf?Object.getPrototypeOf:function(o){return o.__proto__||Object.getPrototypeOf(o)},j(f)}function oe(f,a){var o="data-clipboard-".concat(f);if(a.hasAttribute(o))return a.getAttribute(o)}var ie=function(f){E(o,f);var a=q(o);function o(t,n){var d;return V(this,o),d=a.call(this),d.resolveOptions(n),d.listenClick(t),d}return m(o,[{key:"resolveOptions",value:function(){var n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};this.action=typeof n.action=="function"?n.action:this.defaultAction,this.target=typeof n.target=="function"?n.target:this.defaultTarget,this.text=typeof n.text=="function"?n.text:this.defaultText,this.container=h(n.container)==="object"?n.container:document.body}},{key:"listenClick",value:function(n){var d=this;this.listener=b()(n,"click",function(D){return d.onClick(D)})}},{key:"onClick",value:function(n){var d=n.delegateTarget||n.currentTarget,D=this.action(d)||"copy",G=K({action:D,container:this.container,target:this.target(d),text:this.text(d)});this.emit(G?"success":"error",{action:D,text:G,trigger:d,clearSelection:function(){d&&d.focus(),window.getSelection().removeAllRanges()}})}},{key:"defaultAction",value:function(n){return oe("action",n)}},{key:"defaultTarget",value:function(n){var d=oe("target",n);if(d)return document.querySelector(d)}},{key:"defaultText",value:function(n){return oe("text",n)}},{key:"destroy",value:function(){this.listener.destroy()}}],[{key:"copy",value:function(n){var d=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{container:document.body};return M(n,d)}},{key:"cut",value:function(n){return p(n)}},{key:"isSupported",value:function(){var n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:["copy","cut"],d=typeof n=="string"?[n]:n,D=!!document.queryCommandSupported;return d.forEach(function(G){D=D&&!!document.queryCommandSupported(G)}),D}}]),o}(i()),ue=ie},828:function(r){var s=9;if(typeof Element<"u"&&!Element.prototype.matches){var e=Element.prototype;e.matches=e.matchesSelector||e.mozMatchesSelector||e.msMatchesSelector||e.oMatchesSelector||e.webkitMatchesSelector}function u(i,v){for(;i&&i.nodeType!==s;){if(typeof i.matches=="function"&&i.matches(v))return i;i=i.parentNode}}r.exports=u},438:function(r,s,e){var u=e(828);function i(x,y,g,w,p){var O=b.apply(this,arguments);return x.addEventListener(g,O,p),{destroy:function(){x.removeEventListener(g,O,p)}}}function v(x,y,g,w,p){return typeof x.addEventListener=="function"?i.apply(null,arguments):typeof g=="function"?i.bind(null,document).apply(null,arguments):(typeof x=="string"&&(x=document.querySelectorAll(x)),Array.prototype.map.call(x,function(O){return i(O,y,g,w,p)}))}function b(x,y,g,w){return function(p){p.delegateTarget=u(p.target,y),p.delegateTarget&&w.call(x,p)}}r.exports=v},879:function(r,s){s.node=function(e){return e!==void 0&&e instanceof HTMLElement&&e.nodeType===1},s.nodeList=function(e){var u=Object.prototype.toString.call(e);return e!==void 0&&(u==="[object NodeList]"||u==="[object HTMLCollection]")&&"length"in e&&(e.length===0||s.node(e[0]))},s.string=function(e){return typeof e=="string"||e instanceof String},s.fn=function(e){var u=Object.prototype.toString.call(e);return u==="[object Function]"}},370:function(r,s,e){var u=e(879),i=e(438);function v(g,w,p){if(!g&&!w&&!p)throw new Error("Missing required arguments");if(!u.string(w))throw new TypeError("Second argument must be a String");if(!u.fn(p))throw new TypeError("Third argument must be a Function");if(u.node(g))return b(g,w,p);if(u.nodeList(g))return x(g,w,p);if(u.string(g))return y(g,w,p);throw new TypeError("First argument must be a String, HTMLElement, HTMLCollection, or NodeList")}function b(g,w,p){return g.addEventListener(w,p),{destroy:function(){g.removeEventListener(w,p)}}}function x(g,w,p){return Array.prototype.forEach.call(g,function(O){O.addEventListener(w,p)}),{destroy:function(){Array.prototype.forEach.call(g,function(O){O.removeEventListener(w,p)})}}}function y(g,w,p){return i(document.body,g,w,p)}r.exports=v},817:function(r){function s(e){var u;if(e.nodeName==="SELECT")e.focus(),u=e.value;else if(e.nodeName==="INPUT"||e.nodeName==="TEXTAREA"){var i=e.hasAttribute("readonly");i||e.setAttribute("readonly",""),e.select(),e.setSelectionRange(0,e.value.length),i||e.removeAttribute("readonly"),u=e.value}else{e.hasAttribute("contenteditable")&&e.focus();var v=window.getSelection(),b=document.createRange();b.selectNodeContents(e),v.removeAllRanges(),v.addRange(b),u=v.toString()}return u}r.exports=s},279:function(r){function s(){}s.prototype={on:function(e,u,i){var v=this.e||(this.e={});return(v[e]||(v[e]=[])).push({fn:u,ctx:i}),this},once:function(e,u,i){var v=this;function b(){v.off(e,b),u.apply(i,arguments)}return b._=u,this.on(e,b,i)},emit:function(e){var u=[].slice.call(arguments,1),i=((this.e||(this.e={}))[e]||[]).slice(),v=0,b=i.length;for(v;v<b;v++)i[v].fn.apply(i[v].ctx,u);return this},off:function(e,u){var i=this.e||(this.e={}),v=i[e],b=[];if(v&&u)for(var x=0,y=v.length;x<y;x++)v[x].fn!==u&&v[x].fn._!==u&&b.push(v[x]);return b.length?i[e]=b:delete i[e],this}},r.exports=s,r.exports.TinyEmitter=s}},P={};function I(r){if(P[r])return P[r].exports;var s=P[r]={exports:{}};return U[r](s,s.exports,I),s.exports}return function(){I.n=function(r){var s=r&&r.__esModule?function(){return r.default}:function(){return r};return I.d(s,{a:s}),s}}(),function(){I.d=function(r,s){for(var e in s)I.o(s,e)&&!I.o(r,e)&&Object.defineProperty(r,e,{enumerable:!0,get:s[e]})}}(),function(){I.o=function(r,s){return Object.prototype.hasOwnProperty.call(r,s)}}(),I(686)}().default})})(we);var $e=we.exports;const Ue=Ee($e),Ne=L=>{const C=(L==null?void 0:L.appendToBody)===void 0?!0:L.appendToBody;return{toClipboard(U,P){return new Promise((I,r)=>{const s=document.createElement("button"),e=new Ue(s,{text:()=>U,action:()=>"copy",container:P!==void 0?P:document.body});e.on("success",u=>{e.destroy(),I(u)}),e.on("error",u=>{e.destroy(),r(u)}),C&&document.body.appendChild(s),s.click(),C&&document.body.removeChild(s)})}}},De={id:"teleport-upload-modal",class:"contents"},Fe={class:"title-area"},qe={class:"original"},je={class:"pixell-ai"},He=["src"],ze=["src"],Xe={key:0,class:"timeline-area"},Je={class:"video-menu-area"},Qe=fe({__name:"Video",props:{isUploaded:{type:Boolean},isInferred:{type:Boolean},originalVideoSrc:{},inferredVideoSrc:{}},setup(L){const C=L,U=_(null),P=_(null),I=_(null),r=_(null),s=_(null),e=_(null),u=_(!1),i=_(!1),v=_(!1),b=_(!1),x=_(null),y=_(null),{toClipboard:g}=Ne(),{isUploaded:w,isInferred:p,originalVideoSrc:O,inferredVideoSrc:F}=Ie(C),z=()=>{x.value!==null&&clearTimeout(x.value),g(F.value),v.value=!0,x.value=setTimeout(()=>{v.value=!1},2e3)},M=()=>{y.value!==null&&clearTimeout(y.value);const c=document.createElement("a");c.href=F.value,c.download=F.value,c.click(),b.value=!0,y.value=setTimeout(()=>{b.value=!1},2e3)},R=c=>{const m=U.value;console.log(m);let E=!1;document.onmouseup=()=>{E=!1,i.value=!1};const k=()=>{E=!0,i.value=!0},q=ee=>{if(E&&m!==null){const X=m.getBoundingClientRect();if("pageX"in ee){const j=(ee.pageX-X.left)/m.offsetWidth*100;j<100&&j>0?c.style.left=j+"%":j<=0?c.style.left="0px":j>=100&&(c.style.left="100%")}}},N=()=>{E=!1,i.value=!1};c.onmousedown=k,c.onmouseup=N,m!==null&&(m.onmousemove=q,m.onmouseout=q)},$=c=>{if(i.value){const m=U.value,E=I.value,k=s.value;if(m!==null){const q=m.getBoundingClientRect();if("pageX"in c){const N=(c.pageX-q.left)/m.offsetWidth*100;N<100&&N>0?(E.style.width=N+"%",k.style.width=100/N*100+"%",k.style.zIndex="3"):N<=0?(E.style.width="0",k.style.width="0"):N>=100&&(E.style.width="100%",k.style.width="100%")}}}},K=()=>{r.value!==null&&s.value!==null&&(r.value.paused?(r.value.play(),s.value.play(),u.value=!0):(r.value.pause(),s.value.pause(),u.value=!1))},h=c=>{r.value!==null&&s.value!==null&&(c=="forward"?(s.value.currentTime+=10,r.value.currentTime+=10):(s.value.currentTime-=10,r.value.currentTime-=10))},V=()=>{u.value=!1};return _e(()=>{const c=U.value,m=e.value;m!==null&&c!==null&&(R(m),c.addEventListener("mousemove",$,!1),c.addEventListener("mouseout",$,!1),c.addEventListener("touchstart",$,!1),c.addEventListener("touchmove",$,!1)),r.value!==null&&(r.value.addEventListener("ended",V,!1),r.value.addEventListener("timeupdate",E=>{},!1),r.value.addEventListener("seeking",E=>{r.value!==null&&console.log(Math.floor(r.value.currentTime))},!1))}),(c,m)=>{const E=W("FontAwesomeIcon");return S(),T("div",{class:"video-container",ref_key:"videoContainerRef",ref:U},[l("div",De,[l("div",Fe,[l("div",qe,[l("strong",{class:Y(J(w)?"uploaded":"not-uploaded")},"Original ",2)]),l("div",je,[l("strong",{class:Y(J(p)?"uploaded":"not-uploaded")},"PIXELL AI",2)])]),l("div",{class:"video-area",ref_key:"videoAreaRef",ref:P},[Ve(l("button",{ref_key:"draggableButton",ref:e,class:"drag-btn"},null,512),[[Te,J(p)]]),l("video",{ref_key:"originalVideo",ref:r,src:J(O)},null,8,He),l("div",{id:"video-clipper",ref_key:"videoClipperRef",ref:I},[l("video",{ref_key:"inferenceVideo",ref:s,src:J(F)},null,8,ze)],512),J(p)?(S(),T("button",{key:0,class:"share-btn",onClick:z},[B(ge,{name:"fade",mode:"out-in"},{default:ce(()=>[v.value?(S(),T("span",{key:0,class:"copy-text",onClick:m[0]||(m[0]=de(()=>{},["stop"]))},"copy")):H("",!0)]),_:1})])):H("",!0),J(p)?(S(),T("button",{key:1,class:"download-btn",onClick:M},[B(ge,{name:"fade",mode:"out-in"},{default:ce(()=>[b.value?(S(),T("span",{key:0,class:"download-text",onClick:m[1]||(m[1]=de(()=>{},["stop"]))},"download")):H("",!0)]),_:1})])):H("",!0)],512),J(p)?(S(),T("div",Xe,[l("div",Je,[B(E,{icon:"play",class:"fa-flip-both fa-3x prev-button",onClick:m[2]||(m[2]=k=>h("backward"))}),u.value?(S(),te(E,{key:1,icon:"circle-pause",class:"fa-3x play-button",onClick:K})):(S(),te(E,{key:0,icon:"circle-play",class:"fa-3x play-button",onClick:K})),B(E,{icon:"play",class:"fa-3x next-button",onClick:m[3]||(m[3]=k=>h("forward"))})])])):H("",!0)])],512)}}});const Ye=ve(Qe,[["__scopeId","data-v-24e9f442"]]),Ke="http://222.107.124.161:64000/assets/sample_video_img-8e9d2f79.png",pe=L=>(he("data-v-48f7dcc1"),L=L(),be(),L),Ge={class:"upload-modal-container"},We={class:"contents"},Ze=pe(()=>l("label",{class:"file-upload-txt",for:"file-upload"},"Choose File",-1)),et=pe(()=>l("p",{class:"guide-msg"}," Your Video Files are safely stored and secured using encryption ",-1)),tt={class:"sample-video-area"},nt=pe(()=>l("h3",{class:"h3-title"},"Try Sample Video",-1)),ot={class:"sample-video-list"},at=["onClick"],lt={key:0,class:"file-name-area"},st={class:"file-name"},it={key:1,class:"file-name-area"},rt={class:"upload-btn-area"},ut=fe({__name:"UploadModal",emits:["update:close","update:upload","update:abort"],setup(L,{emit:C}){const U=le("defaultInstance"),P=le("emitter"),I=_([{name:"tes1.mp4"},{name:"tes2.mp4"},{name:"tes3.mp4"}]),r=_(0),s=_(!1),e=_(0),u=_(-1),i=_([]),v=_(!1),b=new AbortController,x=h=>{i.value.length>0?P.emit("update:alert",{isActive:!0,message:"이미 업로드된 파일이 존재합니다."}):u.value=h},y=()=>{v.value=!0},g=()=>{v.value=!1},w=h=>{v.value=!0,h.preventDefault()},p=h=>{if(u.value!==-1)P.emit("update:alert",{isActive:!0,message:"이미 샘플비디오를 선택하셨습니다."});else{h.preventDefault();const V=/\.mp4$/i;v.value=!1;const c=h.dataTransfer;if(c&&c.files)for(const m of c.files)if(V.test(m.name))O(c.files,"drop");else{P.emit("update:alert",{isActive:!0,message:"mp4 확장자만 지원합니다."});break}}},O=(h,V)=>{let c;if(V=="change"?c=h.files:c=h,c!==null)for(let m=0;m<c.length;m++){/\.mp4$/i.test(c[m].name)&&i.value.push({title:c[m].name,file:c[m]});const k=i.value.filter((q,N,ee)=>N===ee.findIndex(X=>X.title===q.title));i.value=k}},F=h=>{i.value.splice(h,1)},z=h=>{if(u.value!==-1)P.emit("update:alert",{isActive:!0,message:"이미 샘플비디오를 선택하셨습니다."});else{const V=h.target;V&&V.files&&O(V,"change")}},M=()=>{C("update:close")},R=()=>{C("update:abort"),b.abort()},$=()=>{Promise.all([U.get(Q.videoList),U.get(Q.inferenceModelList)]).then(h=>{C("update:upload",{videoList:h[0].data,inferenceModelList:h[1].data.data.filter(V=>V!==null)}),M()})},K=()=>{if(i.value.length>0){s.value=!0;const h=i.value,V=new FormData;for(let c=0;c<h.length;c++)console.log(h[c].file),V.append("file",h[c].file);U.postForm(Q.upload,V,{signal:b.signal,onUploadProgress:c=>{const m=c.loaded*100/c.total;e.value=Number(m.toFixed(0)),m==100&&(s.value=!1)},headers:{"Content-Type":"multipart/form-data",type:"video"}}).then(c=>{console.log("output-> result",c),$()})}else P.emit("update:alert",{isActive:!0,message:"파일을 업로드 해주세요."})};return(h,V)=>{const c=W("FontAwesomeIcon"),m=W("BaseButton");return S(),T(ne,null,[s.value?(S(),te(xe,{key:0,text:"video file uploading...",progressValue:e.value,"onUpdate:closeProgressModal":R},null,8,["progressValue"])):H("",!0),l("div",Ge,[l("button",{class:"close-btn",onClick:M}),l("div",We,[l("div",{class:Y(["file-upload-area",v.value?"dragged":""]),onDragenter:y,onDragover:w,onDragleave:g,onDrop:p},[l("strong",null,[Oe(" Drop Video File here to upload or "),Ze,(S(),T("input",{key:r.value,type:"file",id:"file-upload",accept:".mp4",onChange:z,onClick:V[0]||(V[0]=E=>r.value+=1),multiple:""},null,32))])],34),et,l("div",tt,[nt,l("ul",ot,[(S(!0),T(ne,null,re(I.value,(E,k)=>(S(),T("li",{key:k},[l("img",{onClick:q=>x(k),src:Ke,class:Y(k==u.value?"selected":"")},null,10,at)]))),128))])]),i.value.length>0?(S(),T("ul",lt,[(S(!0),T(ne,null,re(i.value,(E,k)=>(S(),T("li",{key:k},[l("span",st,se(E.file.name),1),B(c,{icon:"xmark",class:"delete-button",onClick:q=>F(k)},null,8,["onClick"])]))),128))])):H("",!0),u.value!=-1?(S(),T("ul",it,[l("li",null,se(I.value[u.value].name),1)])):H("",!0),l("div",rt,[B(m,{text:"Upload",onClick:K})])])])],64)}}});const ct=ve(ut,[["__scopeId","data-v-48f7dcc1"]]),Z=L=>(he("data-v-85d906fc"),L=L(),be(),L),dt={class:"upload-area"},ft=Z(()=>l("h2",{class:"h2-title"},"PIXELL AI",-1)),vt={class:"row"},pt={class:"row video-file-select-area"},mt=Z(()=>l("label",{class:"label"},"Video File",-1)),yt={class:"date"},gt=["onClick"],_t={key:0,class:"file-status"},ht={class:"file-size"},bt={class:"setting-area"},xt=Z(()=>l("h2",{class:"h2-title"},"Output Settings",-1)),wt={class:"row"},kt=Z(()=>l("label",{class:"label"},"AI Model",-1)),Ct={class:"row"},St=Z(()=>l("label",{class:"label"},"Format",-1)),Et={class:"row"},At=Z(()=>l("label",{class:"label"},"Encoder",-1)),It={class:"row check-area"},Vt=Z(()=>l("label",{for:"BestQuality"},"Best Quality",-1)),Tt={class:"row check-area"},Ot={class:"row"},Bt=Z(()=>l("label",{class:"bitrate"},"Bitrate : ",-1)),Lt=Z(()=>l("span",{class:"unit"},"(kbps)",-1)),Pt={class:"row"},Mt=fe({__name:"Main",setup(L){const C=le("emitter"),U=le("signOut"),P=Be(),I=_(0),r=le("defaultInstance"),s=_([]),e=_(null),u=_([]),i=_(null),v=[{name:"mp4"},{name:"mov"},{name:"mkv"}],b=_({name:"mp4"}),x=_({name:"H.264",value:"H.264"}),y=_([]),g=_("VBR"),w=_(!1),p=_(!1),O=_("1000"),F=_(0),z=_(!1),M=_(!1),R=_(""),$=_(""),K=_(""),h=_(""),V=()=>{w.value=!0,e.value=null,M.value=!1,z.value=!1,R.value="",$.value=""},c=t=>{console.log(t),z.value=!0,e.value=t,w.value=!1,t.isInference?r.get(Q.videoAlready+`?videoId=${t.videoId}`).then(n=>{console.log(n),M.value=!0,R.value=n.data.data.originalVideo,$.value=n.data.data.inferenceVideo}):(M.value=!1,R.value="",$.value="")},m=Le(()=>{const t=[{name:"H.264",value:"H.264"},{name:"H.265",value:"H.265"},{name:"ProRes(Unable to play video)",value:"ProRes"}];return(b.value.name=="mp4"||b.value.name=="mov")&&(t[2].disabled=!0),t}),E=_(null);let k;const q=t=>{s.value.length==0&&(C.emit("update:alert",{isActive:!0,message:"Please upload your video files."}),t.stopPropagation())},N=t=>{e.value=null,u.value=[],s.value=[],u.value=t.inferenceModelList,s.value=t.videoList},ee=t=>{C.emit("update:alert",{isActive:!0,message:"삭제하시겠습니까?",fn:()=>{C.emit("update:loading",{isLoading:!0}),r.delete(Q.video+`?videoId=${t}`).then(n=>{R.value="",$.value="",z.value=!1,M.value=!1,C.emit("update:loading",{isLoading:!1}),X()})}})},X=()=>{Promise.all([r.get(Q.videoList),r.get(Q.inferenceModelList)]).then(t=>{s.value=t[0].data,u.value=t[1].data.data.filter(n=>n!==null)})},j=t=>{const n=y.value.indexOf(t);n>=0?y.value.splice(n,1):t=="best quality"?(y.value=[],y.value.push("best quality")):y.value.push(t)},oe=()=>{e.value==null?C.emit("update:alert",{isActive:!0,message:"Please select a video file."}):i.value==null?C.emit("update:alert",{isActive:!0,message:"Please select ai model."}):(w.value=!1,M.value=!1,R.value="",$.value="",C.emit("update:loading",{isLoading:!0}),r.post(Q.videoInference,{videoId:e.value&&e.value.videoId,containerId:i.value.containerId,format:b.value.name,encoder:x.value.value,bestQuality:y.value.indexOf("best quality")>=0?1:0,twoPassEncoding:y.value.indexOf("best quality")>=0?0:y.value.indexOf("2-Pass Encoding")>=0?1:0,avgBitrate:y.value.indexOf("best quality")>=0?"1000":O.value,vbr:y.value.indexOf("best quality")>=0?!1:g.value=="VBR",cbr:y.value.indexOf("best quality")>=0?!1:g.value=="CBR"}).then(t=>{sessionStorage.setItem("inference",JSON.stringify({uuid:t.data.data,containerId:i.value.containerId})),K.value=t.data.data,f(t.data.data)}))},ie=()=>{k.close(),p.value=!1,M.value=!1,o({containerId:i.value.containerId,uuid:K.value})},ue=()=>{C.emit("update:alert",{isActive:!0,message:"취소하시겠습니까?",fn:()=>{ie()}})},f=t=>{k=new Re.EventSourcePolyfill("http://222.107.124.161:64000"+Q.connectSSE+`?uuid=${t}`,{headers:{Authorization:P.user.token}}),k.onopen=()=>{C.emit("update:loading",{isLoading:!1})},k.onmessage=n=>{try{if(typeof JSON.parse(n.data)=="object"){const d=JSON.parse(n.data);h.value=d.step,F.value=d.progress,p.value=!0,d.status=="error"&&ie(),d.step=="all"&&d.progress==100&&d.result=="true"&&(k.close(),p.value=!1,sessionStorage.removeItem("inference"),C.emit("update:loading",{isLoading:!0}),R.value=d.originalVideo,$.value=d.inferenceVideo,M.value=!0,X(),C.emit("update:loading",{isLoading:!1}))}}catch{}}},a=t=>{if(p.value)return t.preventDefault(),t.stopImmediatePropagation(),""},o=t=>{C.emit("update:alert",{isActive:!0,message:"추론 정지중입니다. 잠시만 기다려주세요.&nbsp;&nbsp;<div class='loader'></div>"}),r.delete(Q.videoInference+`?containerId=${t.containerId}&uuid=${t.uuid}`).then(n=>{X(),C.emit("update:loading",{isLoading:!1}),C.emit("update:alert",{isActive:!0,message:"추론 정지가 완료되었습니다."}),setTimeout(()=>{C.emit("update:alert",{isActive:!1})},2e3),sessionStorage.removeItem("inference")})};return Pe(()=>{window.removeEventListener("beforeunload",a)}),_e(()=>{window.addEventListener("beforeunload",a),X(),sessionStorage.getItem("inference")!=null&&o(JSON.parse(sessionStorage.getItem("inference")))}),(t,n)=>{const d=W("FontAwesomeIcon"),D=W("BaseButton"),G=W("BaseSelect"),me=W("BaseCheckBox"),ye=W("BaseRadio"),ke=W("BaseInput");return S(),T(ne,null,[p.value?(S(),te(xe,{key:0,text:h.value+" in_progress...",progressValue:F.value,"onUpdate:closeProgressModal":ue},null,8,["text","progressValue"])):H("",!0),l("main",null,[w.value?(S(),te(Me,{key:0,to:"#teleport-upload-modal"},[(S(),te(ct,{key:I.value,"onUpdate:close":n[0]||(n[0]=A=>w.value=!1),"onUpdate:upload":n[1]||(n[1]=A=>N(A)),"onUpdate:abort":n[2]||(n[2]=A=>I.value+=1)}))])):H("",!0),l("aside",null,[l("section",dt,[ft,B(d,{icon:"right-from-bracket",class:"sign-out-button",onClick:J(U)},null,8,["onClick"]),l("div",vt,[B(D,{onClick:V,text:"Upload Video"})]),l("div",pt,[mt,B(G,{onClick:q,name:"fileName",options:s.value,text:e.value==null?"<span class=not-selected>Please Upload Video Files</span>":e.value.fileName},{list:ce(()=>[(S(!0),T(ne,null,re(s.value,(A,Ce)=>(S(),T("li",{class:"optionItem",key:Ce},[l("span",yt,se(A.date),1),(S(!0),T(ne,null,re(A.video,(ae,Rt)=>(S(),T("div",{class:"file-name-area",onClick:Se=>c(ae)},[l("span",{class:"file-name",ref_for:!0,ref_key:"fileName",ref:E},se(ae.fileName),513),l("span",null,[ae.isInference?(S(),T("span",_t,"완료")):H("",!0),l("span",ht,se(ae.fileSize),1),B(d,{icon:"xmark",class:"delete-button",onClick:de(Se=>ee(ae.videoId),["stop"])},null,8,["onClick"])])],8,gt))),256))]))),128))]),_:1},8,["options","text"])])]),l("section",bt,[xt,l("div",wt,[kt,B(G,{"onUpdate:selectBox":n[3]||(n[3]=A=>{i.value=A}),options:u.value,name:"projectName,modelName",text:i.value==null?"<span class=not-selected>Select AI Model</span>":i.value.projectName+"/"+i.value.modelName},null,8,["options","text"])]),l("div",Ct,[St,B(G,{"onUpdate:selectBox":n[4]||(n[4]=A=>b.value=A),options:v,name:"name",text:b.value.name},null,8,["text"])]),l("div",Et,[At,B(G,{"onUpdate:selectBox":n[5]||(n[5]=A=>{A.disabled&&J(C).emit("update:alert",{isActive:!0,message:"Unable to play video"}),x.value=A}),options:m.value,name:"name",text:x.value.name},null,8,["options","text"])]),l("div",It,[l("div",null,[B(me,{"onUpdate:checkModelValue":j,id:"BestQuality",value:"best quality"}),Vt])]),l("div",Tt,[l("div",null,[B(ye,{class:Y(["radio",y.value.indexOf("best quality")<0?"active":"inActive"]),"onUpdate:modelValue":[n[6]||(n[6]=A=>g.value=A),n[7]||(n[7]=A=>g.value=A)],name:"vbrOrCbr",value:"VBR",isDisabled:!(y.value.indexOf("best quality")<0),modelValue:g.value},null,8,["class","isDisabled","modelValue"]),l("label",{for:"VBR",class:Y(y.value.indexOf("best quality")<0?"active":"inActive")},"VBR",2)]),l("div",null,[B(ye,{class:Y(["radio",y.value.indexOf("best quality")<0?"active":"inActive"]),"onUpdate:modelValue":[n[8]||(n[8]=A=>g.value=A),n[9]||(n[9]=A=>g.value=A)],name:"vbrOrCbr",value:"CBR",isDisabled:!(y.value.indexOf("best quality")<0),modelValue:g.value},null,8,["class","isDisabled","modelValue"]),l("label",{for:"CBR",class:Y(y.value.indexOf("best quality")<0?"active":"inActive")},"CBR",2)])]),l("div",Ot,[Bt,B(ke,{"onUpdate:modelValue":n[10]||(n[10]=A=>O.value=A),placeholder:"",type:"text",onlyText:!0,modelValue:y.value.indexOf("best quality")>=0?1e3:O.value,class:Y(y.value.indexOf("best quality")<0?"active":"inActive"),isDisabled:!(y.value.indexOf("best quality")<0)},null,8,["modelValue","class","isDisabled"]),Lt]),l("div",Pt,[B(D,{text:"Preview",class:Y(e.value==null||i.value==null?"inActive":"active"),onClick:oe},null,8,["class"])])])]),B(Ye,{isUploaded:z.value,isInferred:M.value,originalVideoSrc:R.value,inferredVideoSrc:$.value},null,8,["isUploaded","isInferred","originalVideoSrc","inferredVideoSrc"])])],64)}}});const Dt=ve(Mt,[["__scopeId","data-v-85d906fc"]]);export{Dt as default};
