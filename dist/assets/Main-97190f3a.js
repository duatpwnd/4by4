import{v as Ae,w as Ie,d as ve,r as y,x as Ve,o as _e,f as Y,g as L,h as a,y as K,z as X,A as Te,C as Le,j as P,D as de,T as ge,k as z,q as te,m as w,E as fe,_ as pe,i as se,F as Oe,G as ne,H as ue,I as ie,p as he,l as be,c as Be,J as Pe,K as Me,L as Re}from"./index-7c8df232.js";import{P as xe,e as $e}from"./eventsource-af5700ea.js";import{s as J}from"./services-73bde18f.js";var ke={exports:{}};/*!
 * clipboard.js v2.0.11
 * https://clipboardjs.com/
 *
 * Licensed MIT © Zeno Rocha
 */(function(B,C){(function(M,T){B.exports=T()})(Ie,function(){return function(){var D={686:function(r,l,e){e.d(l,{default:function(){return re}});var u=e(279),s=e.n(u),v=e(370),b=e.n(v),x=e(817),g=e.n(x);function _(f){try{return document.execCommand(f)}catch{return!1}}var k=function(i){var o=g()(i);return _("cut"),o},p=k;function O(f){var i=document.documentElement.getAttribute("dir")==="rtl",o=document.createElement("textarea");o.style.fontSize="12pt",o.style.border="0",o.style.padding="0",o.style.margin="0",o.style.position="absolute",o.style[i?"right":"left"]="-9999px";var d=window.pageYOffset||document.documentElement.scrollTop;return o.style.top="".concat(d,"px"),o.setAttribute("readonly",""),o.value=f,o}var j=function(i,o){var d=O(i);o.container.appendChild(d);var t=g()(d);return _("copy"),d.remove(),t},H=function(i){var o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{container:document.body},d="";return typeof i=="string"?d=j(i,o):i instanceof HTMLInputElement&&!["text","search","url","tel","password"].includes(i==null?void 0:i.type)?d=j(i.value,o):(d=g()(i),_("copy")),d},R=H;function $(f){"@babel/helpers - typeof";return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?$=function(o){return typeof o}:$=function(o){return o&&typeof Symbol=="function"&&o.constructor===Symbol&&o!==Symbol.prototype?"symbol":typeof o},$(f)}var U=function(){var i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},o=i.action,d=o===void 0?"copy":o,t=i.container,n=i.target,S=i.text;if(d!=="copy"&&d!=="cut")throw new Error('Invalid "action" value, use either "copy" or "cut"');if(n!==void 0)if(n&&$(n)==="object"&&n.nodeType===1){if(d==="copy"&&n.hasAttribute("disabled"))throw new Error('Invalid "target" attribute. Please use "readonly" instead of "disabled" attribute');if(d==="cut"&&(n.hasAttribute("readonly")||n.hasAttribute("disabled")))throw new Error(`Invalid "target" attribute. You can't cut text from elements with "readonly" or "disabled" attributes`)}else throw new Error('Invalid "target" value, use a valid Element');if(S)return R(S,{container:t});if(n)return d==="cut"?p(n):R(n,{container:t})},Q=U;function h(f){"@babel/helpers - typeof";return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?h=function(o){return typeof o}:h=function(o){return o&&typeof Symbol=="function"&&o.constructor===Symbol&&o!==Symbol.prototype?"symbol":typeof o},h(f)}function V(f,i){if(!(f instanceof i))throw new TypeError("Cannot call a class as a function")}function c(f,i){for(var o=0;o<i.length;o++){var d=i[o];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(f,d.key,d)}}function m(f,i,o){return i&&c(f.prototype,i),o&&c(f,o),f}function E(f,i){if(typeof i!="function"&&i!==null)throw new TypeError("Super expression must either be null or a function");f.prototype=Object.create(i&&i.prototype,{constructor:{value:f,writable:!0,configurable:!0}}),i&&A(f,i)}function A(f,i){return A=Object.setPrototypeOf||function(d,t){return d.__proto__=t,d},A(f,i)}function N(f){var i=Z();return function(){var d=F(f),t;if(i){var n=F(this).constructor;t=Reflect.construct(d,arguments,n)}else t=d.apply(this,arguments);return q(this,t)}}function q(f,i){return i&&(h(i)==="object"||typeof i=="function")?i:W(f)}function W(f){if(f===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return f}function Z(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch{return!1}}function F(f){return F=Object.setPrototypeOf?Object.getPrototypeOf:function(o){return o.__proto__||Object.getPrototypeOf(o)},F(f)}function oe(f,i){var o="data-clipboard-".concat(f);if(i.hasAttribute(o))return i.getAttribute(o)}var ce=function(f){E(o,f);var i=N(o);function o(d,t){var n;return V(this,o),n=i.call(this),n.resolveOptions(t),n.listenClick(d),n}return m(o,[{key:"resolveOptions",value:function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};this.action=typeof t.action=="function"?t.action:this.defaultAction,this.target=typeof t.target=="function"?t.target:this.defaultTarget,this.text=typeof t.text=="function"?t.text:this.defaultText,this.container=h(t.container)==="object"?t.container:document.body}},{key:"listenClick",value:function(t){var n=this;this.listener=b()(t,"click",function(S){return n.onClick(S)})}},{key:"onClick",value:function(t){var n=t.delegateTarget||t.currentTarget,S=this.action(n)||"copy",ee=Q({action:S,container:this.container,target:this.target(n),text:this.text(n)});this.emit(ee?"success":"error",{action:S,text:ee,trigger:n,clearSelection:function(){n&&n.focus(),window.getSelection().removeAllRanges()}})}},{key:"defaultAction",value:function(t){return oe("action",t)}},{key:"defaultTarget",value:function(t){var n=oe("target",t);if(n)return document.querySelector(n)}},{key:"defaultText",value:function(t){return oe("text",t)}},{key:"destroy",value:function(){this.listener.destroy()}}],[{key:"copy",value:function(t){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{container:document.body};return R(t,n)}},{key:"cut",value:function(t){return p(t)}},{key:"isSupported",value:function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:["copy","cut"],n=typeof t=="string"?[t]:t,S=!!document.queryCommandSupported;return n.forEach(function(ee){S=S&&!!document.queryCommandSupported(ee)}),S}}]),o}(s()),re=ce},828:function(r){var l=9;if(typeof Element<"u"&&!Element.prototype.matches){var e=Element.prototype;e.matches=e.matchesSelector||e.mozMatchesSelector||e.msMatchesSelector||e.oMatchesSelector||e.webkitMatchesSelector}function u(s,v){for(;s&&s.nodeType!==l;){if(typeof s.matches=="function"&&s.matches(v))return s;s=s.parentNode}}r.exports=u},438:function(r,l,e){var u=e(828);function s(x,g,_,k,p){var O=b.apply(this,arguments);return x.addEventListener(_,O,p),{destroy:function(){x.removeEventListener(_,O,p)}}}function v(x,g,_,k,p){return typeof x.addEventListener=="function"?s.apply(null,arguments):typeof _=="function"?s.bind(null,document).apply(null,arguments):(typeof x=="string"&&(x=document.querySelectorAll(x)),Array.prototype.map.call(x,function(O){return s(O,g,_,k,p)}))}function b(x,g,_,k){return function(p){p.delegateTarget=u(p.target,g),p.delegateTarget&&k.call(x,p)}}r.exports=v},879:function(r,l){l.node=function(e){return e!==void 0&&e instanceof HTMLElement&&e.nodeType===1},l.nodeList=function(e){var u=Object.prototype.toString.call(e);return e!==void 0&&(u==="[object NodeList]"||u==="[object HTMLCollection]")&&"length"in e&&(e.length===0||l.node(e[0]))},l.string=function(e){return typeof e=="string"||e instanceof String},l.fn=function(e){var u=Object.prototype.toString.call(e);return u==="[object Function]"}},370:function(r,l,e){var u=e(879),s=e(438);function v(_,k,p){if(!_&&!k&&!p)throw new Error("Missing required arguments");if(!u.string(k))throw new TypeError("Second argument must be a String");if(!u.fn(p))throw new TypeError("Third argument must be a Function");if(u.node(_))return b(_,k,p);if(u.nodeList(_))return x(_,k,p);if(u.string(_))return g(_,k,p);throw new TypeError("First argument must be a String, HTMLElement, HTMLCollection, or NodeList")}function b(_,k,p){return _.addEventListener(k,p),{destroy:function(){_.removeEventListener(k,p)}}}function x(_,k,p){return Array.prototype.forEach.call(_,function(O){O.addEventListener(k,p)}),{destroy:function(){Array.prototype.forEach.call(_,function(O){O.removeEventListener(k,p)})}}}function g(_,k,p){return s(document.body,_,k,p)}r.exports=v},817:function(r){function l(e){var u;if(e.nodeName==="SELECT")e.focus(),u=e.value;else if(e.nodeName==="INPUT"||e.nodeName==="TEXTAREA"){var s=e.hasAttribute("readonly");s||e.setAttribute("readonly",""),e.select(),e.setSelectionRange(0,e.value.length),s||e.removeAttribute("readonly"),u=e.value}else{e.hasAttribute("contenteditable")&&e.focus();var v=window.getSelection(),b=document.createRange();b.selectNodeContents(e),v.removeAllRanges(),v.addRange(b),u=v.toString()}return u}r.exports=l},279:function(r){function l(){}l.prototype={on:function(e,u,s){var v=this.e||(this.e={});return(v[e]||(v[e]=[])).push({fn:u,ctx:s}),this},once:function(e,u,s){var v=this;function b(){v.off(e,b),u.apply(s,arguments)}return b._=u,this.on(e,b,s)},emit:function(e){var u=[].slice.call(arguments,1),s=((this.e||(this.e={}))[e]||[]).slice(),v=0,b=s.length;for(v;v<b;v++)s[v].fn.apply(s[v].ctx,u);return this},off:function(e,u){var s=this.e||(this.e={}),v=s[e],b=[];if(v&&u)for(var x=0,g=v.length;x<g;x++)v[x].fn!==u&&v[x].fn._!==u&&b.push(v[x]);return b.length?s[e]=b:delete s[e],this}},r.exports=l,r.exports.TinyEmitter=l}},M={};function T(r){if(M[r])return M[r].exports;var l=M[r]={exports:{}};return D[r](l,l.exports,T),l.exports}return function(){T.n=function(r){var l=r&&r.__esModule?function(){return r.default}:function(){return r};return T.d(l,{a:l}),l}}(),function(){T.d=function(r,l){for(var e in l)T.o(l,e)&&!T.o(r,e)&&Object.defineProperty(r,e,{enumerable:!0,get:l[e]})}}(),function(){T.o=function(r,l){return Object.prototype.hasOwnProperty.call(r,l)}}(),T(686)}().default})})(ke);var Ue=ke.exports;const Ne=Ae(Ue),De=B=>{const C=(B==null?void 0:B.appendToBody)===void 0?!0:B.appendToBody;return{toClipboard(D,M){return new Promise((T,r)=>{const l=document.createElement("button"),e=new Ne(l,{text:()=>D,action:()=>"copy",container:M!==void 0?M:document.body});e.on("success",u=>{e.destroy(),T(u)}),e.on("error",u=>{e.destroy(),r(u)}),C&&document.body.appendChild(l),l.click(),C&&document.body.removeChild(l)})}}},Fe={id:"teleport-upload-modal",class:"contents"},qe={class:"title-area"},je={class:"original"},He={class:"pixell-ai"},ze=["src"],Xe=["src"],Je={key:0,class:"timeline-area"},Ke={class:"video-menu-area"},Qe=ve({__name:"Video",props:{isUploaded:{type:Boolean},isInferred:{type:Boolean},originalVideoSrc:{},inferredVideoSrc:{}},setup(B){const C=B,D=y(null),M=y(null),T=y(null),r=y(null),l=y(null),e=y(null),u=y(!1),s=y(!1),v=y(!1),b=y(!1),x=y(null),g=y(null),{toClipboard:_}=De(),{isUploaded:k,isInferred:p,originalVideoSrc:O,inferredVideoSrc:j}=Ve(C),H=()=>{x.value!==null&&clearTimeout(x.value),_(j.value),v.value=!0,x.value=setTimeout(()=>{v.value=!1},2e3)},R=()=>{g.value!==null&&clearTimeout(g.value);const c=document.createElement("a");c.href=j.value,c.download=j.value,c.click(),b.value=!0,g.value=setTimeout(()=>{b.value=!1},2e3)},$=c=>{const m=D.value;console.log(m);let E=!1;document.onmouseup=()=>{E=!1,s.value=!1};const A=()=>{E=!0,s.value=!0},N=W=>{if(E&&m!==null){const Z=m.getBoundingClientRect();if("pageX"in W){const F=(W.pageX-Z.left)/m.offsetWidth*100;F<100&&F>0?c.style.left=F+"%":F<=0?c.style.left="0px":F>=100&&(c.style.left="100%")}}},q=()=>{E=!1,s.value=!1};c.onmousedown=A,c.onmouseup=q,m!==null&&(m.onmousemove=N,m.onmouseout=N)},U=c=>{if(s.value){const m=D.value,E=T.value,A=l.value;if(m!==null){const N=m.getBoundingClientRect();if("pageX"in c){const q=(c.pageX-N.left)/m.offsetWidth*100;q<100&&q>0?(E.style.width=q+"%",A.style.width=100/q*100+"%",A.style.zIndex="3"):q<=0?(E.style.width="0",A.style.width="0"):q>=100&&(E.style.width="100%",A.style.width="100%")}}}},Q=()=>{r.value!==null&&l.value!==null&&(r.value.paused?(r.value.play(),l.value.play(),u.value=!0):(r.value.pause(),l.value.pause(),u.value=!1))},h=c=>{r.value!==null&&l.value!==null&&(c=="forward"?(l.value.currentTime+=10,r.value.currentTime+=10):(l.value.currentTime-=10,r.value.currentTime-=10))},V=()=>{u.value=!1};return _e(()=>{const c=D.value,m=e.value;m!==null&&c!==null&&($(m),c.addEventListener("mousemove",U,!1),c.addEventListener("mouseout",U,!1),c.addEventListener("touchstart",U,!1),c.addEventListener("touchmove",U,!1)),r.value!==null&&(r.value.addEventListener("ended",V,!1),r.value.addEventListener("timeupdate",E=>{},!1),r.value.addEventListener("seeking",E=>{r.value!==null&&console.log(Math.floor(r.value.currentTime))},!1))}),(c,m)=>{const E=Y("FontAwesomeIcon");return w(),L("div",{class:"video-container",ref_key:"videoContainerRef",ref:D},[a("div",Fe,[a("div",qe,[a("div",je,[a("strong",{class:K(X(k)?"uploaded":"not-uploaded")},"Original ",2)]),a("div",He,[a("strong",{class:K(X(p)?"uploaded":"not-uploaded")},"PIXELL AI",2)])]),a("div",{class:"video-area",ref_key:"videoAreaRef",ref:M},[Te(a("button",{ref_key:"draggableButton",ref:e,class:"drag-btn"},null,512),[[Le,X(p)]]),a("video",{ref_key:"originalVideo",ref:r,src:X(O)},null,8,ze),a("div",{id:"video-clipper",ref_key:"videoClipperRef",ref:T},[a("video",{ref_key:"inferenceVideo",ref:l,src:X(j)},null,8,Xe)],512),X(p)?(w(),L("button",{key:0,class:"share-btn",onClick:H},[P(ge,{name:"fade",mode:"out-in"},{default:de(()=>[v.value?(w(),L("span",{key:0,class:"copy-text",onClick:m[0]||(m[0]=fe(()=>{},["stop"]))},"copy")):z("",!0)]),_:1})])):z("",!0),X(p)?(w(),L("button",{key:1,class:"download-btn",onClick:R},[P(ge,{name:"fade",mode:"out-in"},{default:de(()=>[b.value?(w(),L("span",{key:0,class:"download-text",onClick:m[1]||(m[1]=fe(()=>{},["stop"]))},"download")):z("",!0)]),_:1})])):z("",!0)],512),X(p)?(w(),L("div",Je,[a("div",Ke,[P(E,{icon:"play",class:"fa-flip-both fa-3x prev-button",onClick:m[2]||(m[2]=A=>h("backward"))}),u.value?(w(),te(E,{key:1,icon:"circle-pause",class:"fa-3x play-button",onClick:Q})):(w(),te(E,{key:0,icon:"circle-play",class:"fa-3x play-button",onClick:Q})),P(E,{icon:"play",class:"fa-3x next-button",onClick:m[3]||(m[3]=A=>h("forward"))})])])):z("",!0)])],512)}}});const Ye=pe(Qe,[["__scopeId","data-v-d795bbec"]]),Ge="http://222.107.124.161:64000/assets/sample_video_img-8e9d2f79.png",me=B=>(he("data-v-48f7dcc1"),B=B(),be(),B),We={class:"upload-modal-container"},Ze={class:"contents"},et=me(()=>a("label",{class:"file-upload-txt",for:"file-upload"},"Choose File",-1)),tt=me(()=>a("p",{class:"guide-msg"}," Your Video Files are safely stored and secured using encryption ",-1)),nt={class:"sample-video-area"},ot=me(()=>a("h3",{class:"h3-title"},"Try Sample Video",-1)),at={class:"sample-video-list"},lt=["onClick"],st={key:0,class:"file-name-area"},it={class:"file-name"},rt={key:1,class:"file-name-area"},ut={class:"upload-btn-area"},ct=ve({__name:"UploadModal",emits:["update:close","update:upload","update:abort"],setup(B,{emit:C}){const D=se("defaultInstance"),M=se("emitter"),T=y([{name:"tes1.mp4"},{name:"tes2.mp4"},{name:"tes3.mp4"}]),r=y(0),l=y(!1),e=y(0),u=y(-1),s=y([]),v=y(!1),b=new AbortController,x=h=>{s.value.length>0?M.emit("update:alert",{isActive:!0,message:"이미 업로드된 파일이 존재합니다."}):u.value=h},g=()=>{v.value=!0},_=()=>{v.value=!1},k=h=>{v.value=!0,h.preventDefault()},p=h=>{if(u.value!==-1)M.emit("update:alert",{isActive:!0,message:"이미 샘플비디오를 선택하셨습니다."});else{h.preventDefault();const V=/\.mp4$/i;v.value=!1;const c=h.dataTransfer;if(c&&c.files)for(const m of c.files)if(V.test(m.name))O(c.files,"drop");else{M.emit("update:alert",{isActive:!0,message:"mp4 확장자만 지원합니다."});break}}},O=(h,V)=>{let c;if(V=="change"?c=h.files:c=h,c!==null)for(let m=0;m<c.length;m++){/\.mp4$/i.test(c[m].name)&&s.value.push({title:c[m].name,file:c[m]});const A=s.value.filter((N,q,W)=>q===W.findIndex(Z=>Z.title===N.title));s.value=A}},j=h=>{s.value.splice(h,1)},H=h=>{if(u.value!==-1)M.emit("update:alert",{isActive:!0,message:"이미 샘플비디오를 선택하셨습니다."});else{const V=h.target;V&&V.files&&O(V,"change")}},R=()=>{C("update:close")},$=()=>{C("update:abort"),b.abort()},U=()=>{Promise.all([D.get(J.videoList),D.get(J.inferenceModelList)]).then(h=>{C("update:upload",{videoList:h[0].data,inferenceModelList:h[1].data.data.filter(V=>V!==null)}),R()})},Q=()=>{if(s.value.length>0){l.value=!0;const h=s.value,V=new FormData;for(let c=0;c<h.length;c++)console.log(h[c].file),V.append("file",h[c].file);D.postForm(J.upload,V,{signal:b.signal,onUploadProgress:c=>{const m=c.loaded*100/c.total;e.value=Number(m.toFixed(0)),m==100&&(l.value=!1)},headers:{"Content-Type":"multipart/form-data",type:"video"}}).then(c=>{console.log("output-> result",c),U()})}else M.emit("update:alert",{isActive:!0,message:"파일을 업로드 해주세요."})};return(h,V)=>{const c=Y("FontAwesomeIcon"),m=Y("BaseButton");return w(),L(ne,null,[l.value?(w(),te(xe,{key:0,text:"video file uploading...",progressValue:e.value,"onUpdate:closeProgressModal":$},null,8,["progressValue"])):z("",!0),a("div",We,[a("button",{class:"close-btn",onClick:R}),a("div",Ze,[a("div",{class:K(["file-upload-area",v.value?"dragged":""]),onDragenter:g,onDragover:k,onDragleave:_,onDrop:p},[a("strong",null,[Oe(" Drop Video File here to upload or "),et,(w(),L("input",{key:r.value,type:"file",id:"file-upload",accept:".mp4",onChange:H,onClick:V[0]||(V[0]=E=>r.value+=1),multiple:""},null,32))])],34),tt,a("div",nt,[ot,a("ul",at,[(w(!0),L(ne,null,ue(T.value,(E,A)=>(w(),L("li",{key:A},[a("img",{onClick:N=>x(A),src:Ge,class:K(A==u.value?"selected":"")},null,10,lt)]))),128))])]),s.value.length>0?(w(),L("ul",st,[(w(!0),L(ne,null,ue(s.value,(E,A)=>(w(),L("li",{key:A},[a("span",it,ie(E.file.name),1),P(c,{icon:"xmark",class:"delete-button",onClick:N=>j(A)},null,8,["onClick"])]))),128))])):z("",!0),u.value!=-1?(w(),L("ul",rt,[a("li",null,ie(T.value[u.value].name),1)])):z("",!0),a("div",ut,[P(m,{text:"Upload",onClick:Q})])])])],64)}}});const dt=pe(ct,[["__scopeId","data-v-48f7dcc1"]]),G=B=>(he("data-v-d5d00308"),B=B(),be(),B),ft={class:"upload-area"},vt=G(()=>a("h2",{class:"h2-title"},"PIXELL AI",-1)),pt={class:"row"},mt={class:"row video-file-select-area"},yt=G(()=>a("label",{class:"label"},"Video File",-1)),gt={class:"date"},_t=["onClick"],ht={key:0,class:"file-status"},bt={class:"file-size"},xt={class:"setting-area"},kt=G(()=>a("h2",{class:"h2-title"},"Output Settings",-1)),wt={class:"row"},Ct=G(()=>a("label",{class:"label"},"AI Model",-1)),St={class:"row"},Et=G(()=>a("label",{class:"label"},"Format",-1)),At={class:"row"},It=G(()=>a("label",{class:"label"},"Encoder",-1)),Vt={class:"row check-area"},Tt=G(()=>a("label",{for:"BestQuality"},"Best Quality",-1)),Lt={class:"row check-area"},Ot={class:"row"},Bt=G(()=>a("label",{class:"bitrate"},"Bitrate : ",-1)),Pt=G(()=>a("span",{class:"unit"},"(kbps)",-1)),Mt={class:"row"},Rt=ve({__name:"Main",setup(B){const C=se("emitter"),D=se("signOut"),M=Be(),T=y(0),r=se("defaultInstance"),l=y([]),e=y(null),u=y([]),s=y(null),v=[{name:"mp4"},{name:"mov"},{name:"mkv"}],b=y({name:"mp4"}),x=y({name:"H.264",value:"H.264"}),g=y([]),_=y("VBR"),k=y(!1),p=y(!1),O=y("1000"),j=y(0),H=y(!1),R=y(!1),$=y(""),U=y(""),Q=y(""),h=y(""),V=y(0),c=()=>{k.value=!0,e.value=null,R.value=!1,H.value=!1,$.value="",U.value=""},m=t=>{V.value+=1,H.value=!0,e.value=t,k.value=!1,t.isInference?r.get(J.videoAlready+`?videoId=${t.videoId}`).then(n=>{console.log(n),R.value=!0,$.value=n.data.data.originalVideo,U.value=n.data.data.inferenceVideo}):(R.value=!1,$.value="",U.value="")},E=Pe(()=>{const t=[{name:"H.264",value:"H.264"},{name:"H.265",value:"H.265"},{name:"ProRes(Unable to play video)",value:"ProRes"}];return(b.value.name=="mp4"||b.value.name=="mov")&&(t[2].disabled=!0),t}),A=y(null);let N;const q=t=>{l.value.length==0&&(C.emit("update:alert",{isActive:!0,message:"Please upload your video files."}),t.stopPropagation())},W=t=>{e.value=null,u.value=[],l.value=[],u.value=t.inferenceModelList,l.value=t.videoList;const n=t.videoList[t.videoList.length-1].video.findLastIndex(S=>S.isInference==!1);H.value=!0,e.value=t.videoList[t.videoList.length-1].video[n]},Z=t=>{C.emit("update:alert",{isActive:!0,message:"삭제하시겠습니까?",fn:()=>{C.emit("update:loading",{isLoading:!0}),r.delete(J.video+`?videoId=${t}`).then(n=>{$.value="",U.value="",H.value=!1,R.value=!1,C.emit("update:loading",{isLoading:!1}),F()})}})},F=()=>{Promise.all([r.get(J.videoList),r.get(J.inferenceModelList)]).then(t=>{l.value=t[0].data,u.value=t[1].data.data.filter(n=>n!==null)})},oe=t=>{const n=g.value.indexOf(t);n>=0?g.value.splice(n,1):t=="best quality"?(g.value=[],g.value.push("best quality")):g.value.push(t)},ce=()=>{e.value==null?C.emit("update:alert",{isActive:!0,message:"Please select a video file."}):s.value==null?C.emit("update:alert",{isActive:!0,message:"Please select ai model."}):(k.value=!1,R.value=!1,$.value="",U.value="",C.emit("update:loading",{isLoading:!0}),r.post(J.videoInference,{videoId:e.value&&e.value.videoId,containerId:s.value.containerId,format:b.value.name,encoder:x.value.value,bestQuality:g.value.indexOf("best quality")>=0?1:0,twoPassEncoding:g.value.indexOf("best quality")>=0?0:g.value.indexOf("2-Pass Encoding")>=0?1:0,avgBitrate:g.value.indexOf("best quality")>=0?"1000":O.value,vbr:g.value.indexOf("best quality")>=0?!1:_.value=="VBR",cbr:g.value.indexOf("best quality")>=0?!1:_.value=="CBR"}).then(t=>{sessionStorage.setItem("inference",JSON.stringify({uuid:t.data.data,containerId:s.value.containerId})),Q.value=t.data.data,i(t.data.data)}))},re=()=>{N.close(),p.value=!1,R.value=!1,d({containerId:s.value.containerId,uuid:Q.value})},f=()=>{C.emit("update:alert",{isActive:!0,message:"취소하시겠습니까?",fn:()=>{re()}})},i=t=>{N=new $e.EventSourcePolyfill("http://222.107.124.161:64000"+J.connectSSE+`?uuid=${t}`,{headers:{Authorization:M.user.token}}),N.onopen=()=>{C.emit("update:loading",{isLoading:!1})},N.onmessage=n=>{try{if(typeof JSON.parse(n.data)=="object"){const S=JSON.parse(n.data);h.value=S.step,j.value=S.progress,p.value=!0,S.status=="error"&&re(),S.step=="all"&&S.progress==100&&S.result=="true"&&(N.close(),p.value=!1,sessionStorage.removeItem("inference"),C.emit("update:loading",{isLoading:!0}),$.value=S.originalVideo,U.value=S.inferenceVideo,R.value=!0,F(),C.emit("update:loading",{isLoading:!1}))}}catch{}}},o=t=>{if(p.value)return t.preventDefault(),t.stopImmediatePropagation(),""},d=t=>{C.emit("update:alert",{isActive:!0,message:"추론 정지중입니다. 잠시만 기다려주세요.&nbsp;&nbsp;<div class='loader'></div>"}),r.delete(J.videoInference+`?containerId=${t.containerId}&uuid=${t.uuid}`).then(n=>{F(),C.emit("update:loading",{isLoading:!1}),C.emit("update:alert",{isActive:!0,message:"추론 정지가 완료되었습니다."}),setTimeout(()=>{C.emit("update:alert",{isActive:!1})},2e3),sessionStorage.removeItem("inference")})};return Me(()=>{window.removeEventListener("beforeunload",o)}),_e(()=>{window.addEventListener("beforeunload",o),F(),sessionStorage.getItem("inference")!=null&&d(JSON.parse(sessionStorage.getItem("inference")))}),(t,n)=>{const S=Y("FontAwesomeIcon"),ee=Y("BaseButton"),ae=Y("BaseSelect"),we=Y("BaseCheckBox"),ye=Y("BaseRadio"),Ce=Y("BaseInput");return w(),L(ne,null,[p.value?(w(),te(xe,{key:0,text:h.value+" in_progress...",progressValue:j.value,"onUpdate:closeProgressModal":f},null,8,["text","progressValue"])):z("",!0),a("main",null,[k.value?(w(),te(Re,{key:0,to:"#teleport-upload-modal"},[(w(),te(dt,{key:T.value,"onUpdate:close":n[0]||(n[0]=I=>k.value=!1),"onUpdate:upload":n[1]||(n[1]=I=>W(I)),"onUpdate:abort":n[2]||(n[2]=I=>T.value+=1)}))])):z("",!0),a("aside",null,[a("section",ft,[vt,P(S,{icon:"right-from-bracket",class:"sign-out-button",onClick:X(D)},null,8,["onClick"]),a("div",pt,[P(ee,{onClick:c,text:"Upload Video"})]),a("div",mt,[yt,P(ae,{onClick:q,name:"fileName",options:l.value,text:e.value==null?"<span class=not-selected>Please Upload Video Files</span>":e.value.fileName},{list:de(()=>[(w(!0),L(ne,null,ue(l.value,(I,Se)=>(w(),L("li",{class:"optionItem",key:Se},[a("span",gt,ie(I.date),1),(w(!0),L(ne,null,ue(I.video,(le,$t)=>(w(),L("div",{class:"file-name-area",onClick:Ee=>m(le)},[a("span",{class:"file-name",ref_for:!0,ref_key:"fileName",ref:A},ie(le.fileName),513),a("span",null,[le.isInference?(w(),L("span",ht,"완료")):z("",!0),a("span",bt,ie(le.fileSize),1),P(S,{icon:"xmark",class:"delete-button",onClick:fe(Ee=>Z(le.videoId),["stop"])},null,8,["onClick"])])],8,_t))),256))]))),128))]),_:1},8,["options","text"])])]),a("section",xt,[kt,a("div",wt,[Ct,P(ae,{"onUpdate:selectBox":n[3]||(n[3]=I=>{s.value=I}),options:u.value,name:"projectName,modelName",text:s.value==null?"<span class=not-selected>Select AI Model</span>":s.value.projectName+"/"+s.value.modelName},null,8,["options","text"])]),a("div",St,[Et,P(ae,{"onUpdate:selectBox":n[4]||(n[4]=I=>b.value=I),options:v,name:"name",text:b.value.name},null,8,["text"])]),a("div",At,[It,P(ae,{"onUpdate:selectBox":n[5]||(n[5]=I=>{I.disabled&&X(C).emit("update:alert",{isActive:!0,message:"Unable to play video"}),x.value=I}),options:E.value,name:"name",text:x.value.name},null,8,["options","text"])]),a("div",Vt,[a("div",null,[P(we,{"onUpdate:checkModelValue":oe,id:"BestQuality",value:"best quality"}),Tt])]),a("div",Lt,[a("div",null,[P(ye,{class:K(["radio",g.value.indexOf("best quality")<0?"active":"inActive"]),"onUpdate:modelValue":[n[6]||(n[6]=I=>_.value=I),n[7]||(n[7]=I=>_.value=I)],name:"vbrOrCbr",value:"VBR",isDisabled:!(g.value.indexOf("best quality")<0),modelValue:_.value},null,8,["class","isDisabled","modelValue"]),a("label",{for:"VBR",class:K(g.value.indexOf("best quality")<0?"active":"inActive")},"VBR",2)]),a("div",null,[P(ye,{class:K(["radio",g.value.indexOf("best quality")<0?"active":"inActive"]),"onUpdate:modelValue":[n[8]||(n[8]=I=>_.value=I),n[9]||(n[9]=I=>_.value=I)],name:"vbrOrCbr",value:"CBR",isDisabled:!(g.value.indexOf("best quality")<0),modelValue:_.value},null,8,["class","isDisabled","modelValue"]),a("label",{for:"CBR",class:K(g.value.indexOf("best quality")<0?"active":"inActive")},"CBR",2)])]),a("div",Ot,[Bt,P(Ce,{"onUpdate:modelValue":n[10]||(n[10]=I=>O.value=I),placeholder:"",type:"text",onlyText:!0,modelValue:g.value.indexOf("best quality")>=0?1e3:O.value,class:K(g.value.indexOf("best quality")<0?"active":"inActive"),isDisabled:!(g.value.indexOf("best quality")<0)},null,8,["modelValue","class","isDisabled"]),Pt]),a("div",Mt,[P(ee,{text:"Preview",class:K(e.value==null||s.value==null?"inActive":"active"),onClick:ce},null,8,["class"])])])]),(w(),te(Ye,{isUploaded:H.value,isInferred:R.value,originalVideoSrc:$.value,inferredVideoSrc:U.value,key:V.value},null,8,["isUploaded","isInferred","originalVideoSrc","inferredVideoSrc"]))])],64)}}});const Ft=pe(Rt,[["__scopeId","data-v-d5d00308"]]);export{Ft as default};
