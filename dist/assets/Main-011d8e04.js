import{v as ke,w as Se,d as fe,r as g,x as Ee,o as ge,f as Q,g as B,h as o,y as z,z as H,A as Ae,C as Ie,j as O,D as ce,T as ye,k as X,q as te,m as k,E as de,_ as ve,i as ae,F as Ve,G as ne,H as re,I as le,p as _e,l as be,c as Te,J as Oe,K as Be,L as Le}from"./index-cfbb2c03.js";import{P as he,e as Pe}from"./eventsource-4bac637d.js";import{s as Y}from"./services-b33b6e54.js";var xe={exports:{}};/*!
 * clipboard.js v2.0.11
 * https://clipboardjs.com/
 *
 * Licensed MIT © Zeno Rocha
 */(function(L,C){(function(P,I){L.exports=I()})(Se,function(){return function(){var R={686:function(i,a,t){t.d(a,{default:function(){return se}});var r=t(279),l=t.n(r),v=t(370),h=t.n(v),x=t(817),m=t.n(x);function y(f){try{return document.execCommand(f)}catch{return!1}}var w=function(n){var e=m()(n);return y("cut"),e},p=w;function T(f){var n=document.documentElement.getAttribute("dir")==="rtl",e=document.createElement("textarea");e.style.fontSize="12pt",e.style.border="0",e.style.padding="0",e.style.margin="0",e.style.position="absolute",e.style[n?"right":"left"]="-9999px";var s=window.pageYOffset||document.documentElement.scrollTop;return e.style.top="".concat(s,"px"),e.setAttribute("readonly",""),e.value=f,e}var D=function(n,e){var s=T(n);e.container.appendChild(s);var d=m()(s);return y("copy"),s.remove(),d},G=function(n){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{container:document.body},s="";return typeof n=="string"?s=D(n,e):n instanceof HTMLInputElement&&!["text","search","url","tel","password"].includes(n==null?void 0:n.type)?s=D(n.value,e):(s=m()(n),y("copy")),s},$=G;function F(f){"@babel/helpers - typeof";return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?F=function(e){return typeof e}:F=function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},F(f)}var q=function(){var n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},e=n.action,s=e===void 0?"copy":e,d=n.container,_=n.target,U=n.text;if(s!=="copy"&&s!=="cut")throw new Error('Invalid "action" value, use either "copy" or "cut"');if(_!==void 0)if(_&&F(_)==="object"&&_.nodeType===1){if(s==="copy"&&_.hasAttribute("disabled"))throw new Error('Invalid "target" attribute. Please use "readonly" instead of "disabled" attribute');if(s==="cut"&&(_.hasAttribute("readonly")||_.hasAttribute("disabled")))throw new Error(`Invalid "target" attribute. You can't cut text from elements with "readonly" or "disabled" attributes`)}else throw new Error('Invalid "target" value, use a valid Element');if(U)return $(U,{container:d});if(_)return s==="cut"?p(_):$(_,{container:d})},J=q;function b(f){"@babel/helpers - typeof";return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?b=function(e){return typeof e}:b=function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},b(f)}function V(f,n){if(!(f instanceof n))throw new TypeError("Cannot call a class as a function")}function u(f,n){for(var e=0;e<n.length;e++){var s=n[e];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(f,s.key,s)}}function c(f,n,e){return n&&u(f.prototype,n),e&&u(f,e),f}function S(f,n){if(typeof n!="function"&&n!==null)throw new TypeError("Super expression must either be null or a function");f.prototype=Object.create(n&&n.prototype,{constructor:{value:f,writable:!0,configurable:!0}}),n&&A(f,n)}function A(f,n){return A=Object.setPrototypeOf||function(s,d){return s.__proto__=d,s},A(f,n)}function j(f){var n=Z();return function(){var s=N(f),d;if(n){var _=N(this).constructor;d=Reflect.construct(s,arguments,_)}else d=s.apply(this,arguments);return M(this,d)}}function M(f,n){return n&&(b(n)==="object"||typeof n=="function")?n:W(f)}function W(f){if(f===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return f}function Z(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch{return!1}}function N(f){return N=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},N(f)}function oe(f,n){var e="data-clipboard-".concat(f);if(n.hasAttribute(e))return n.getAttribute(e)}var ue=function(f){S(e,f);var n=j(e);function e(s,d){var _;return V(this,e),_=n.call(this),_.resolveOptions(d),_.listenClick(s),_}return c(e,[{key:"resolveOptions",value:function(){var d=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};this.action=typeof d.action=="function"?d.action:this.defaultAction,this.target=typeof d.target=="function"?d.target:this.defaultTarget,this.text=typeof d.text=="function"?d.text:this.defaultText,this.container=b(d.container)==="object"?d.container:document.body}},{key:"listenClick",value:function(d){var _=this;this.listener=h()(d,"click",function(U){return _.onClick(U)})}},{key:"onClick",value:function(d){var _=d.delegateTarget||d.currentTarget,U=this.action(_)||"copy",ee=J({action:U,container:this.container,target:this.target(_),text:this.text(_)});this.emit(ee?"success":"error",{action:U,text:ee,trigger:_,clearSelection:function(){_&&_.focus(),window.getSelection().removeAllRanges()}})}},{key:"defaultAction",value:function(d){return oe("action",d)}},{key:"defaultTarget",value:function(d){var _=oe("target",d);if(_)return document.querySelector(_)}},{key:"defaultText",value:function(d){return oe("text",d)}},{key:"destroy",value:function(){this.listener.destroy()}}],[{key:"copy",value:function(d){var _=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{container:document.body};return $(d,_)}},{key:"cut",value:function(d){return p(d)}},{key:"isSupported",value:function(){var d=arguments.length>0&&arguments[0]!==void 0?arguments[0]:["copy","cut"],_=typeof d=="string"?[d]:d,U=!!document.queryCommandSupported;return _.forEach(function(ee){U=U&&!!document.queryCommandSupported(ee)}),U}}]),e}(l()),se=ue},828:function(i){var a=9;if(typeof Element<"u"&&!Element.prototype.matches){var t=Element.prototype;t.matches=t.matchesSelector||t.mozMatchesSelector||t.msMatchesSelector||t.oMatchesSelector||t.webkitMatchesSelector}function r(l,v){for(;l&&l.nodeType!==a;){if(typeof l.matches=="function"&&l.matches(v))return l;l=l.parentNode}}i.exports=r},438:function(i,a,t){var r=t(828);function l(x,m,y,w,p){var T=h.apply(this,arguments);return x.addEventListener(y,T,p),{destroy:function(){x.removeEventListener(y,T,p)}}}function v(x,m,y,w,p){return typeof x.addEventListener=="function"?l.apply(null,arguments):typeof y=="function"?l.bind(null,document).apply(null,arguments):(typeof x=="string"&&(x=document.querySelectorAll(x)),Array.prototype.map.call(x,function(T){return l(T,m,y,w,p)}))}function h(x,m,y,w){return function(p){p.delegateTarget=r(p.target,m),p.delegateTarget&&w.call(x,p)}}i.exports=v},879:function(i,a){a.node=function(t){return t!==void 0&&t instanceof HTMLElement&&t.nodeType===1},a.nodeList=function(t){var r=Object.prototype.toString.call(t);return t!==void 0&&(r==="[object NodeList]"||r==="[object HTMLCollection]")&&"length"in t&&(t.length===0||a.node(t[0]))},a.string=function(t){return typeof t=="string"||t instanceof String},a.fn=function(t){var r=Object.prototype.toString.call(t);return r==="[object Function]"}},370:function(i,a,t){var r=t(879),l=t(438);function v(y,w,p){if(!y&&!w&&!p)throw new Error("Missing required arguments");if(!r.string(w))throw new TypeError("Second argument must be a String");if(!r.fn(p))throw new TypeError("Third argument must be a Function");if(r.node(y))return h(y,w,p);if(r.nodeList(y))return x(y,w,p);if(r.string(y))return m(y,w,p);throw new TypeError("First argument must be a String, HTMLElement, HTMLCollection, or NodeList")}function h(y,w,p){return y.addEventListener(w,p),{destroy:function(){y.removeEventListener(w,p)}}}function x(y,w,p){return Array.prototype.forEach.call(y,function(T){T.addEventListener(w,p)}),{destroy:function(){Array.prototype.forEach.call(y,function(T){T.removeEventListener(w,p)})}}}function m(y,w,p){return l(document.body,y,w,p)}i.exports=v},817:function(i){function a(t){var r;if(t.nodeName==="SELECT")t.focus(),r=t.value;else if(t.nodeName==="INPUT"||t.nodeName==="TEXTAREA"){var l=t.hasAttribute("readonly");l||t.setAttribute("readonly",""),t.select(),t.setSelectionRange(0,t.value.length),l||t.removeAttribute("readonly"),r=t.value}else{t.hasAttribute("contenteditable")&&t.focus();var v=window.getSelection(),h=document.createRange();h.selectNodeContents(t),v.removeAllRanges(),v.addRange(h),r=v.toString()}return r}i.exports=a},279:function(i){function a(){}a.prototype={on:function(t,r,l){var v=this.e||(this.e={});return(v[t]||(v[t]=[])).push({fn:r,ctx:l}),this},once:function(t,r,l){var v=this;function h(){v.off(t,h),r.apply(l,arguments)}return h._=r,this.on(t,h,l)},emit:function(t){var r=[].slice.call(arguments,1),l=((this.e||(this.e={}))[t]||[]).slice(),v=0,h=l.length;for(v;v<h;v++)l[v].fn.apply(l[v].ctx,r);return this},off:function(t,r){var l=this.e||(this.e={}),v=l[t],h=[];if(v&&r)for(var x=0,m=v.length;x<m;x++)v[x].fn!==r&&v[x].fn._!==r&&h.push(v[x]);return h.length?l[t]=h:delete l[t],this}},i.exports=a,i.exports.TinyEmitter=a}},P={};function I(i){if(P[i])return P[i].exports;var a=P[i]={exports:{}};return R[i](a,a.exports,I),a.exports}return function(){I.n=function(i){var a=i&&i.__esModule?function(){return i.default}:function(){return i};return I.d(a,{a}),a}}(),function(){I.d=function(i,a){for(var t in a)I.o(a,t)&&!I.o(i,t)&&Object.defineProperty(i,t,{enumerable:!0,get:a[t]})}}(),function(){I.o=function(i,a){return Object.prototype.hasOwnProperty.call(i,a)}}(),I(686)}().default})})(xe);var Me=xe.exports;const Re=ke(Me),$e=L=>{const C=(L==null?void 0:L.appendToBody)===void 0?!0:L.appendToBody;return{toClipboard(R,P){return new Promise((I,i)=>{const a=document.createElement("button"),t=new Re(a,{text:()=>R,action:()=>"copy",container:P!==void 0?P:document.body});t.on("success",r=>{t.destroy(),I(r)}),t.on("error",r=>{t.destroy(),i(r)}),C&&document.body.appendChild(a),a.click(),C&&document.body.removeChild(a)})}}},Ne={id:"teleport-upload-modal",class:"contents"},Ue={class:"title-area"},De={class:"original"},Fe={class:"pixell-ai"},qe=["src"],je=["src"],He={key:0,class:"timeline-area"},ze={class:"video-menu-area"},Xe=fe({__name:"Video",props:{isUploaded:{type:Boolean},isInferred:{type:Boolean},originalVideoSrc:{},inferredVideoSrc:{}},setup(L){const C=L,R=g(null),P=g(null),I=g(null),i=g(null),a=g(null),t=g(null),r=g(!1),l=g(!1),v=g(!1),h=g(!1),x=g(null),m=g(null),{toClipboard:y}=$e(),{isUploaded:w,isInferred:p,originalVideoSrc:T,inferredVideoSrc:D}=Ee(C),G=()=>{x.value!==null&&clearTimeout(x.value),y(D.value),v.value=!0,x.value=setTimeout(()=>{v.value=!1},2e3)},$=()=>{m.value!==null&&clearTimeout(m.value);const u=document.createElement("a");u.href=D.value,u.download=D.value,u.click(),h.value=!0,m.value=setTimeout(()=>{h.value=!1},2e3)},F=u=>{const c=R.value;console.log(c);let S=!1;document.onmouseup=()=>{S=!1,l.value=!1};const A=()=>{S=!0,l.value=!0},j=W=>{if(S&&c!==null){const Z=c.getBoundingClientRect();if("pageX"in W){const N=(W.pageX-Z.left)/c.offsetWidth*100;N<100&&N>0?u.style.left=N+"%":N<=0?u.style.left="0px":N>=100&&(u.style.left="100%")}}},M=()=>{S=!1,l.value=!1};u.onmousedown=A,u.onmouseup=M,c!==null&&(c.onmousemove=j,c.onmouseout=j)},q=u=>{if(l.value){const c=R.value,S=I.value,A=a.value;if(c!==null){const j=c.getBoundingClientRect();if("pageX"in u){const M=(u.pageX-j.left)/c.offsetWidth*100;M<100&&M>0?(S.style.width=M+"%",A.style.width=100/M*100+"%",A.style.zIndex="3"):M<=0?(S.style.width="0",A.style.width="0"):M>=100&&(S.style.width="100%",A.style.width="100%")}}}},J=()=>{i.value!==null&&a.value!==null&&(i.value.paused?(i.value.play(),a.value.play(),r.value=!0):(i.value.pause(),a.value.pause(),r.value=!1))},b=u=>{i.value!==null&&a.value!==null&&(u=="forward"?(a.value.currentTime+=10,i.value.currentTime+=10):(a.value.currentTime-=10,i.value.currentTime-=10))},V=()=>{r.value=!1};return ge(()=>{const u=R.value,c=t.value;c!==null&&u!==null&&(F(c),u.addEventListener("mousemove",q,!1),u.addEventListener("mouseout",q,!1),u.addEventListener("touchstart",q,!1),u.addEventListener("touchmove",q,!1)),i.value!==null&&(i.value.addEventListener("ended",V,!1),i.value.addEventListener("timeupdate",S=>{},!1),i.value.addEventListener("seeking",S=>{i.value!==null&&console.log(Math.floor(i.value.currentTime))},!1))}),(u,c)=>{const S=Q("FontAwesomeIcon");return k(),B("div",{class:"video-container",ref_key:"videoContainerRef",ref:R},[o("div",Ne,[o("div",Ue,[o("div",De,[o("strong",{class:z(H(w)?"uploaded":"not-uploaded")},"Original ",2)]),o("div",Fe,[o("strong",{class:z(H(p)?"uploaded":"not-uploaded")},"PIXELL AI",2)])]),o("div",{class:"video-area",ref_key:"videoAreaRef",ref:P},[Ae(o("button",{ref_key:"draggableButton",ref:t,class:"drag-btn"},null,512),[[Ie,H(p)]]),o("video",{ref_key:"originalVideo",ref:i,src:H(T)},null,8,qe),o("div",{id:"video-clipper",ref_key:"videoClipperRef",ref:I},[o("video",{ref_key:"inferenceVideo",ref:a,src:H(D)},null,8,je)],512),H(p)?(k(),B("button",{key:0,class:"share-btn",onClick:G},[O(ye,{name:"fade",mode:"out-in"},{default:ce(()=>[v.value?(k(),B("span",{key:0,class:"copy-text",onClick:c[0]||(c[0]=de(()=>{},["stop"]))},"copy")):X("",!0)]),_:1})])):X("",!0),H(p)?(k(),B("button",{key:1,class:"download-btn",onClick:$},[O(ye,{name:"fade",mode:"out-in"},{default:ce(()=>[h.value?(k(),B("span",{key:0,class:"download-text",onClick:c[1]||(c[1]=de(()=>{},["stop"]))},"download")):X("",!0)]),_:1})])):X("",!0)],512),H(p)?(k(),B("div",He,[o("div",ze,[O(S,{icon:"play",class:"fa-flip-both fa-3x prev-button",onClick:c[2]||(c[2]=A=>b("backward"))}),r.value?(k(),te(S,{key:1,icon:"circle-pause",class:"fa-3x play-button",onClick:J})):(k(),te(S,{key:0,icon:"circle-play",class:"fa-3x play-button",onClick:J})),O(S,{icon:"play",class:"fa-3x next-button",onClick:c[3]||(c[3]=A=>b("forward"))})])])):X("",!0)])],512)}}});const Je=ve(Xe,[["__scopeId","data-v-509244af"]]),Qe="http://222.107.124.161:64000/assets/sample_video_img-8e9d2f79.png",pe=L=>(_e("data-v-e7ebe5a6"),L=L(),be(),L),Ye={class:"upload-modal-container"},Ke={class:"contents"},Ge=pe(()=>o("label",{class:"file-upload-txt",for:"file-upload"},"Choose File",-1)),We=pe(()=>o("p",{class:"guide-msg"}," Your Video Files are safely stored and secured using encryption ",-1)),Ze={class:"sample-video-area"},et=pe(()=>o("h3",{class:"h3-title"},"Try Sample Video",-1)),tt={class:"sample-video-list"},nt=["onClick"],ot={key:0,class:"file-name-area"},at={class:"file-name"},lt={key:1,class:"file-name-area"},st={class:"upload-btn-area"},it=fe({__name:"UploadModal",emits:["update:close","update:upload","update:abort"],setup(L,{emit:C}){const R=ae("defaultInstance"),P=ae("emitter"),I=g([{name:"tes1.mp4"},{name:"tes2.mp4"},{name:"tes3.mp4"}]),i=g(0),a=g(!1),t=g(0),r=g(-1),l=g([]),v=g(!1),h=new AbortController,x=b=>{l.value.length>0?P.emit("update:alert",{isActive:!0,message:"이미 업로드된 파일이 존재합니다."}):r.value=b},m=()=>{v.value=!0},y=()=>{v.value=!1},w=b=>{v.value=!0,b.preventDefault()},p=b=>{if(r.value!==-1)P.emit("update:alert",{isActive:!0,message:"이미 샘플비디오를 선택하셨습니다."});else{b.preventDefault();const V=/\.mp4$/i;v.value=!1;const u=b.dataTransfer;if(u&&u.files)for(const c of u.files)if(V.test(c.name))T(u.files,"drop");else{P.emit("update:alert",{isActive:!0,message:"mp4 확장자만 지원합니다."});break}}},T=(b,V)=>{let u;if(V=="change"?u=b.files:u=b,u!==null)for(let c=0;c<u.length;c++){/\.mp4$/i.test(u[c].name)&&l.value.push({title:u[c].name,file:u[c]});const A=l.value.filter((j,M,W)=>M===W.findIndex(Z=>Z.title===j.title));l.value=A}},D=b=>{l.value.splice(b,1)},G=b=>{if(r.value!==-1)P.emit("update:alert",{isActive:!0,message:"이미 샘플비디오를 선택하셨습니다."});else{const V=b.target;V&&V.files&&T(V,"change")}},$=()=>{C("update:close")},F=()=>{C("update:abort"),h.abort()},q=()=>{Promise.all([R.get(Y.videoList),R.get(Y.inferenceModelList)]).then(b=>{C("update:upload",{videoList:b[0].data,inferenceModelList:b[1].data.data.filter(V=>V!==null)}),$()})},J=()=>{if(l.value.length>0){a.value=!0;const b=l.value,V=new FormData;for(let u=0;u<b.length;u++)console.log(b[u].file),V.append("file",b[u].file);R.postForm(Y.upload,V,{signal:h.signal,onUploadProgress:u=>{const c=u.loaded*100/u.total;t.value=Number(c.toFixed(0)),c==100&&(a.value=!1)},headers:{"Content-Type":"multipart/form-data",type:"video"}}).then(u=>{console.log("output-> result",u),q()})}else P.emit("update:alert",{isActive:!0,message:"파일을 업로드 해주세요."})};return(b,V)=>{const u=Q("FontAwesomeIcon"),c=Q("BaseButton");return k(),B(ne,null,[a.value?(k(),te(he,{key:0,text:"video file uploading...",progressValue:t.value,"onUpdate:closeProgressModal":F},null,8,["progressValue"])):X("",!0),o("div",Ye,[o("button",{class:"close-btn",onClick:$}),o("div",Ke,[o("div",{class:z(["file-upload-area",v.value?"dragged":""]),onDragenter:m,onDragover:w,onDragleave:y,onDrop:p},[o("strong",null,[Ve(" Drop Video File here to upload or "),Ge,(k(),B("input",{key:i.value,type:"file",id:"file-upload",accept:".mp4",onChange:G,onClick:V[0]||(V[0]=S=>i.value+=1),multiple:""},null,32))])],34),We,o("div",Ze,[et,o("ul",tt,[(k(!0),B(ne,null,re(I.value,(S,A)=>(k(),B("li",{key:A},[o("img",{onClick:j=>x(A),src:Qe,class:z(A==r.value?"selected":"")},null,10,nt)]))),128))])]),l.value.length>0?(k(),B("ul",ot,[(k(!0),B(ne,null,re(l.value,(S,A)=>(k(),B("li",{key:A},[o("span",at,le(S.file.name),1),O(u,{icon:"xmark",class:"delete-button",onClick:j=>D(A)},null,8,["onClick"])]))),128))])):X("",!0),r.value!=-1?(k(),B("ul",lt,[o("li",null,le(I.value[r.value].name),1)])):X("",!0),o("div",st,[O(c,{text:"Upload",onClick:J})])])])],64)}}});const rt=ve(it,[["__scopeId","data-v-e7ebe5a6"]]),K=L=>(_e("data-v-38f10bf6"),L=L(),be(),L),ut={class:"upload-area"},ct=K(()=>o("h2",{class:"h2-title"},"PIXELL AI",-1)),dt={class:"row"},ft={class:"row video-file-select-area"},vt=K(()=>o("label",{class:"label"},"Video File",-1)),pt={class:"date"},mt=["onClick"],yt={class:"file-size"},gt={class:"setting-area"},_t=K(()=>o("h2",{class:"h2-title"},"Output Settings",-1)),bt={class:"row"},ht=K(()=>o("label",{class:"label"},"AI Model",-1)),xt={class:"row"},wt=K(()=>o("label",{class:"label"},"Format",-1)),Ct={class:"row"},kt=K(()=>o("label",{class:"label"},"Encoder",-1)),St={class:"row check-area"},Et=K(()=>o("label",{for:"BestQuality"},"Best Quality",-1)),At={class:"row check-area"},It={class:"row"},Vt=K(()=>o("label",{class:"bitrate"},"Bitrate : ",-1)),Tt=K(()=>o("span",{class:"unit"},"(kbps)",-1)),Ot={class:"row"},Bt=fe({__name:"Main",setup(L){const C=ae("emitter"),R=ae("signOut"),P=Te(),I=g(0),i=ae("defaultInstance"),a=g([]),t=g(null),r=g([]),l=g(null),v=[{name:"mp4"},{name:"mov"},{name:"mkv"}],h=g({name:"mp4"}),x=g({name:"H.264",value:"H.264"}),m=g([]),y=g("VBR"),w=g(!1),p=g(!1),T=g("1000"),D=g(0),G=g(!1),$=g(!1),F=g(""),q=g(""),J=g(""),b=g(""),V=Oe(()=>{const n=[{name:"H.264",value:"H.264"},{name:"H.265",value:"H.265"},{name:"ProRes(Unable to play video)",value:"ProRes"}];return(h.value.name=="mp4"||h.value.name=="mov")&&(n[2].disabled=!0),n}),u=g(null);let c;const S=n=>{a.value.length==0&&(C.emit("update:alert",{isActive:!0,message:"Please upload your video files."}),n.stopPropagation())},A=n=>{t.value=null,r.value=[],a.value=[],r.value=n.inferenceModelList,a.value=n.videoList},j=n=>{C.emit("update:alert",{isActive:!0,message:"삭제하시겠습니까?",fn:()=>{C.emit("update:loading",{isLoading:!0}),i.delete(Y.video+`?videoId=${n}`).then(e=>{C.emit("update:loading",{isLoading:!1}),M()})}})},M=()=>{Promise.all([i.get(Y.videoList),i.get(Y.inferenceModelList)]).then(n=>{a.value=n[0].data,r.value=n[1].data.data.filter(e=>e!==null)})},W=n=>{const e=m.value.indexOf(n);e>=0?m.value.splice(e,1):n=="best quality"?(m.value=[],m.value.push("best quality")):m.value.push(n)},Z=()=>{t.value==null?C.emit("update:alert",{isActive:!0,message:"Please select a video file."}):l.value==null?C.emit("update:alert",{isActive:!0,message:"Please select ai model."}):(w.value=!1,$.value=!1,F.value="",q.value="",C.emit("update:loading",{isLoading:!0}),i.post(Y.videoInference,{videoId:t.value&&t.value.videoId,containerId:l.value.containerId,format:h.value.name,encoder:x.value.value,bestQuality:m.value.indexOf("best quality")>=0?1:0,twoPassEncoding:m.value.indexOf("best quality")>=0?0:m.value.indexOf("2-Pass Encoding")>=0?1:0,avgBitrate:m.value.indexOf("best quality")>=0?"1000":T.value,vbr:m.value.indexOf("best quality")>=0?!1:y.value=="VBR",cbr:m.value.indexOf("best quality")>=0?!1:y.value=="CBR"}).then(n=>{sessionStorage.setItem("inference",JSON.stringify({uuid:n.data.data,containerId:l.value.containerId})),J.value=n.data.data,ue(n.data.data)}))},N=()=>{c.close(),p.value=!1,$.value=!1,f({containerId:l.value.containerId,uuid:J.value})},oe=()=>{C.emit("update:alert",{isActive:!0,message:"취소하시겠습니까?",fn:()=>{N()}})},ue=n=>{c=new Pe.EventSourcePolyfill("http://222.107.124.161:64000"+Y.connectSSE+`?uuid=${n}`,{headers:{Authorization:P.user.token}}),c.onopen=()=>{C.emit("update:loading",{isLoading:!1})},c.onmessage=e=>{try{if(typeof JSON.parse(e.data)=="object"){const s=JSON.parse(e.data);b.value=s.step,D.value=s.progress,p.value=!0,s.status=="error"&&N(),s.step=="all"&&s.progress==100&&s.result=="true"&&(c.close(),p.value=!1,sessionStorage.removeItem("inference"),C.emit("update:loading",{isLoading:!0}),F.value=s.originalVideo,q.value=s.inferenceVideo,$.value=!0,C.emit("update:loading",{isLoading:!1}))}}catch{}}},se=n=>{if(p.value)return n.preventDefault(),n.stopImmediatePropagation(),""},f=n=>{C.emit("update:alert",{isActive:!0,message:"추론 정지중입니다. 잠시만 기다려주세요.&nbsp;&nbsp;<div class='loader'></div>"}),i.delete(Y.videoInference+`?containerId=${n.containerId}&uuid=${n.uuid}`).then(e=>{M(),C.emit("update:loading",{isLoading:!1}),C.emit("update:alert",{isActive:!0,message:"추론 정지가 완료되었습니다."}),setTimeout(()=>{C.emit("update:alert",{isActive:!1})},2e3),sessionStorage.removeItem("inference")})};return Be(()=>{window.removeEventListener("beforeunload",se)}),ge(()=>{window.addEventListener("beforeunload",se),M(),sessionStorage.getItem("inference")!=null&&f(JSON.parse(sessionStorage.getItem("inference")))}),(n,e)=>{const s=Q("FontAwesomeIcon"),d=Q("BaseButton"),_=Q("BaseSelect"),U=Q("BaseCheckBox"),ee=Q("BaseRadio"),me=Q("BaseInput");return k(),B(ne,null,[p.value?(k(),te(he,{key:0,text:b.value+" in_progress...",progressValue:D.value,"onUpdate:closeProgressModal":oe},null,8,["text","progressValue"])):X("",!0),o("main",null,[w.value?(k(),te(Le,{key:0,to:"#teleport-upload-modal"},[(k(),te(rt,{key:I.value,"onUpdate:close":e[0]||(e[0]=E=>w.value=!1),"onUpdate:upload":e[1]||(e[1]=E=>A(E)),"onUpdate:abort":e[2]||(e[2]=E=>I.value+=1)}))])):X("",!0),o("aside",null,[o("section",ut,[ct,O(s,{icon:"right-from-bracket",class:"sign-out-button",onClick:H(R)},null,8,["onClick"]),o("div",dt,[O(d,{onClick:e[3]||(e[3]=E=>w.value=!0),text:"Upload Video"})]),o("div",ft,[vt,O(_,{onClick:S,name:"fileName",options:a.value,text:t.value==null?"<span class=not-selected>Please Upload Video Files</span>":t.value.fileName},{list:ce(()=>[(k(!0),B(ne,null,re(a.value,(E,we)=>(k(),B("li",{class:"optionItem",key:we},[o("span",pt,le(E.date),1),(k(!0),B(ne,null,re(E.video,(ie,Lt)=>(k(),B("div",{class:"file-name-area",onClick:Ce=>{G.value=!0,t.value=ie}},[o("span",{class:"file-name",ref_for:!0,ref_key:"fileName",ref:u},le(ie.fileName),513),o("span",null,[o("span",yt,le(ie.fileSize),1),O(s,{icon:"xmark",class:"delete-button",onClick:de(Ce=>j(ie.videoId),["stop"])},null,8,["onClick"])])],8,mt))),256))]))),128))]),_:1},8,["options","text"])])]),o("section",gt,[_t,o("div",bt,[ht,O(_,{"onUpdate:selectBox":e[4]||(e[4]=E=>{l.value=E}),options:r.value,name:"projectName,modelName",text:l.value==null?"<span class=not-selected>Select AI Model</span>":l.value.projectName+"/"+l.value.modelName},null,8,["options","text"])]),o("div",xt,[wt,O(_,{"onUpdate:selectBox":e[5]||(e[5]=E=>h.value=E),options:v,name:"name",text:h.value.name},null,8,["text"])]),o("div",Ct,[kt,O(_,{"onUpdate:selectBox":e[6]||(e[6]=E=>{E.disabled&&H(C).emit("update:alert",{isActive:!0,message:"Unable to play video"}),x.value=E}),options:V.value,name:"name",text:x.value.name},null,8,["options","text"])]),o("div",St,[o("div",null,[O(U,{"onUpdate:checkModelValue":W,id:"BestQuality",value:"best quality"}),Et])]),o("div",At,[o("div",null,[O(ee,{class:z(["radio",m.value.indexOf("best quality")<0?"active":"inActive"]),"onUpdate:modelValue":[e[7]||(e[7]=E=>y.value=E),e[8]||(e[8]=E=>y.value=E)],name:"vbrOrCbr",value:"VBR",isDisabled:!(m.value.indexOf("best quality")<0),modelValue:y.value},null,8,["class","isDisabled","modelValue"]),o("label",{for:"VBR",class:z(m.value.indexOf("best quality")<0?"active":"inActive")},"VBR",2)]),o("div",null,[O(ee,{class:z(["radio",m.value.indexOf("best quality")<0?"active":"inActive"]),"onUpdate:modelValue":[e[9]||(e[9]=E=>y.value=E),e[10]||(e[10]=E=>y.value=E)],name:"vbrOrCbr",value:"CBR",isDisabled:!(m.value.indexOf("best quality")<0),modelValue:y.value},null,8,["class","isDisabled","modelValue"]),o("label",{for:"CBR",class:z(m.value.indexOf("best quality")<0?"active":"inActive")},"CBR",2)])]),o("div",It,[Vt,O(me,{"onUpdate:modelValue":e[11]||(e[11]=E=>T.value=E),placeholder:"",type:"text",onlyText:!0,modelValue:m.value.indexOf("best quality")>=0?1e3:T.value,class:z(m.value.indexOf("best quality")<0?"active":"inActive"),isDisabled:!(m.value.indexOf("best quality")<0)},null,8,["modelValue","class","isDisabled"]),Tt]),o("div",Ot,[O(d,{text:"Preview",class:z(t.value==null||l.value==null?"inActive":"active"),onClick:Z},null,8,["class"])])])]),O(Je,{isUploaded:G.value,isInferred:$.value,originalVideoSrc:F.value,inferredVideoSrc:q.value},null,8,["isUploaded","isInferred","originalVideoSrc","inferredVideoSrc"])])],64)}}});const $t=ve(Bt,[["__scopeId","data-v-38f10bf6"]]);export{$t as default};
